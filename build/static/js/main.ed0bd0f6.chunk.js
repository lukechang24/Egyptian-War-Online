(this["webpackJsonpegyptian-war"]=this["webpackJsonpegyptian-war"]||[]).push([[0],{36:function(e,n,t){e.exports=t(51)},41:function(e,n,t){},51:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(31),o=t.n(r),s=(t(41),t(8)),p=t(12),l=t(14),u=t(13),d=t(11),c=t(9),g=i.a.createContext(null),h=function(e){return function(n){return i.a.createElement(g.Consumer,null,(function(t){return i.a.createElement(e,Object.assign({},n,{firebase:t}))}))}},m=g,f=t(19),b=(t(42),t(43),t(45),{apiKey:"AIzaSyBWxMmUdKeRYfvPFKe5dsto2RdprUf7MtA",authDomain:"egyptian-war.firebaseapp.com",databaseURL:"https://egyptian-war.firebaseio.com",projectId:"egyptian-war",storageBucket:"egyptian-war.appspot.com",messagingSenderId:526714168101}),k=function e(){var n=this;Object(s.a)(this,e),this.createRoom=function(){return n.db.collection("rooms")},this.findRoom=function(e){return n.db.collection("rooms").doc(e)},f.initializeApp(b),this.database=f.database(),this.db=f.firestore(),this.auth=f.auth()},v=t(4),y=t(5);function w(){var e=Object(v.a)(["\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    width: 100px;\n    height: 50px;\n"]);return w=function(){return e},e}function S(){var e=Object(v.a)(["\n\n"]);return S=function(){return e},e}function C(){var e=Object(v.a)(["\n    position: absolute;\n    right: 0;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    margin: auto;\n    width: 100px;\n    transform: ",";\n    border: 1px solid black;\n    border-radius: 15px;\n"]);return C=function(){return e},e}function U(){var e=Object(v.a)(["\n    position: relative;\n    width: 250px;\n    height: 250px;\n    z-index: -1;\n"]);return U=function(){return e},e}function x(){var e=Object(v.a)(["\n    /* position: absolute; */\n    /* bottom: 100%;\n    left: 100%; */\n    /* top: -","px; */\n    width: 102.5px;\n    transition: 0.2s linear;\n    &.move {\n        transform: translate(75px, calc(-100vh/2 + 102.5px));\n    }\n"]);return x=function(){return e},e}function j(){var e=Object(v.a)(["\n    position: relative;\n    display: flex;\n    justify-content: center;\n    margin-top: 25px;\n"]);return j=function(){return e},e}function R(){var e=Object(v.a)(["\n    width: 100px;\n    z-index: 100;\n    transition: ",";\n    &.move {\n        transform: translate(-50px, calc(-100vh/2 + 102.5px));\n    }\n"]);return R=function(){return e},e}function O(){var e=Object(v.a)(["\n    width: ",";\n    height: ",";\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    transform: ",";\n"]);return O=function(){return e},e}function E(){var e=Object(v.a)(["\n    position: absolute;\n    top: ",";\n    left: ",";\n    width: 250px;\n    height: 250px;\n    display: flex;\n    flex-direction: ",";\n    justify-content: center;\n    align-items: center;\n    background-color: lightblue;\n    border: 5px solid white;\n    &.highlight {\n        border: 5px solid greenyellow;\n    }\n"]);return E=function(){return e},e}function D(){var e=Object(v.a)(["\n    position: relative;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    overflow-x: hidden;\n"]);return D=function(){return e},e}var H={};H.Container1=y.a.div(D()),H.PlayerContainer=y.a.div(E(),(function(e){return"bottom"===e.position?"calc(100vh - 250px)":"top"===e.position?0:"left"===e.position||"right"===e.position?"calc(calc((100vh - 250px)/2))":0}),(function(e){return"bottom"===e.position||"top"===e.position?"calc((100vw - 250px)/2)":"left"===e.position?0:"right"===e.position?"calc(100vw - 250px)":0}),(function(e){return"bottom"===e.position?"column-reverse":"column"})),H.Container2=y.a.div(O(),(function(e){return"left"===e.position||"right"===e.position?"auto":"100%"}),(function(e){return"left"===e.position||"right"===e.position?"100%":"auto"}),(function(e){return"top"===e.position?"rotate(180deg)":"left"===e.position?"rotate(90deg)":"right"===e.position?"rotate(270deg)":0})),H.Hand=y.a.img(R(),(function(e){return"slower"===e.speed?"5s linear":"0.1s linear"})),H.CardContainer=y.a.div(j()),H.CardBack=y.a.img(x(),(function(e){return e.layer?2*e.layer:0})),H.Pile=y.a.div(U()),H.Card=y.a.img(C(),(function(e){return"rotate(".concat(e.skew,"deg) translate(").concat(e.translateX,"px, ").concat(e.translateY,"px)")})),H.Name=y.a.h1(S()),H.StartButton=y.a.button(w());var I=H,T=function(e){Object(l.a)(t,e);var n=Object(u.a)(t);function t(){var e;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).unsubscribe=null,e.startGame=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){var t=n.data().players,a=Math.floor(Math.random()*t.length),i=t[a].id,r=e.props.deck;t.forEach((function(n){n.hand=r.splice(0,Math.floor(52/e.props.players.length))})),console.log(r),t[a].hand=t[a].hand.concat(r),e.props.firebase.findRoom(n.id).update({players:t,whoseTurn:i,phase:"idle"})}))},e.prepareCard=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){e.props.firebase.findRoom(n.id).update({phase:"playing"}),setTimeout((function(){e.placeCard()}),100)}))},e.placeCard=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){for(var t=localStorage.getItem("id"),a=n.data().players,i=n.data().pile,r=null,o=null,s=null,p=0;p<a.length;p++)if(a[p].id===t){var l=a[p].hand,u=l.pop();u.skew=100*Math.random()-50,u.translateX=30*Math.random()-15,u.translateY=30*Math.random()-15,i.push(u),a[p].hand=l,o="jack"===u.rank?1:"queen"===u.rank?2:"king"===u.rank?3:"ace"===u.rank?4:null,s=o>0?t:n.data().whoseRoyal,r=p===a.length-1?a[0].id:a[p+1].id}if(n.data().royalCount>1&&!o)console.log("i went first"),o=n.data().royalCount-1,r=t;else if(1===n.data().royalCount&&!o)return e.props.firebase.findRoom(n.id).update({players:a,pile:i,phase:"finished"}),void(e.unsubscribe=setTimeout((function(){for(var t=0;t<a.length;t++)if(a[t].id===n.data().whoseRoyal){var p=a[t].hand.reverse().concat(i);a[t].hand=p.reverse(),i=[],s=null,o=null,r=a[t].id,console.log(r,"updated"),e.props.firebase.findRoom(n.id).update({players:a,pile:i,royalCount:o,whoseRoyal:s,whoseTurn:r,phase:"idle"})}}),3e3));e.props.firebase.findRoom(n.id).update({players:a,pile:i,royalCount:o,whoseRoyal:s,whoseTurn:r,phase:"idle"})}))},e.prepareSlap=function(){var n=localStorage.getItem("id");e.props.firebase.findRoom(e.props.match.params.id).get().then((function(t){e.props.firebase.findRoom(t.id).update({phase:"slapping",whoseSlapping:[].concat(Object(d.a)(t.data().whoseSlapping),[n])}),setTimeout((function(){e.slap()}),1500)}))},e.slap=function(){var n=localStorage.getItem("id"),t=Object(d.a)(e.props.pile);if(t.length<=1||t[t.length-1].rank!==t[t.length-2].rank&&2===t.length){if(0===t.length)return;e.burn()}else t[t.length-1].rank===t[t.length-2].rank||t[t.length-1].rank===t[t.length-3].rank?(clearTimeout(e.unsubscribe),e.props.firebase.findRoom(e.props.match.params.id).get().then((function(a){for(var i=a.data().players,r=a.data().whoseTurn,o=0;o<i.length;o++)if(i[o].id===n&&e.props.whoseSlapping[0]===i[o].id){var s=i[o].hand.reverse().concat(t);i[o].hand=s.reverse(),r=i[o].id}e.props.firebase.findRoom(a.id).update({players:i,pile:[],royalCount:null,whoseRoyal:null,whoseTurn:r,phase:"idle",whoseSlapping:[]})}))):n===e.props.whoseSlapping[0]&&(console.log("IM HERE",e.props.whoseSlapping),e.burn())},e.burn=function(){var n=localStorage.getItem("id");e.props.firebase.findRoom(e.props.match.params.id).get().then((function(t){for(var a=t.data().players,i=t.data().pile,r=0;r<a.length;r++)if(a[r].id===n){var o=a[r].hand,s=o.pop();s.skew=360*Math.random()-180,s.translateX=30*Math.random()-15,s.translateY=30*Math.random()-15,i.unshift(s),a[r].hand=o}e.props.firebase.findRoom(t.id).update({players:a,pile:i,phase:"idle",whoseSlapping:[]})}))},e.createDelay=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){var t=n.data().players,a=n.data().pile,i=null,r=null;e.unsubscribe=setTimeout((function(){for(var o=0;o<t.length;o++)if(t[o].id===n.data().whoseRoyal){var s=t[o].hand.reverse().concat(a);return t[o].hand=s.reverse(),a=[],r=null,i=null,void e.props.firebase.findRoom(n.id).update({players:t,pile:a,royalCount:i,whoseRoyal:r,phase:"idle"})}}),1e3)}))},e.rotateIds=function(n,t){var a=Object(d.a)(t);if(e.props.checkIfExists(n,a))for(;a[0].id!==n;)a.unshift(a.pop());else console.log("id not found");return a},e}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,n=localStorage.getItem("id");document.addEventListener("keydown",(function(t){"idle"===e.props.phase&&38===t.which&&n===e.props.whoseTurn?e.prepareCard():32===t.which&&e.props.pile.length>0&&e.props.whoseSlapping.indexOf(n)<0&&e.prepareSlap()}))}},{key:"render",value:function(){var e=this,n=localStorage.getItem("id"),t=this.rotateIds(n,this.props.players).map((function(n,t,a){var r=n.hand.slice(0,1).map((function(t,a){return i.a.createElement(I.CardBack,{className:"playing"===e.props.phase&&e.props.whoseTurn===n.id&&0===a?"move":"",key:a,layer:a,src:"images/back2.png"})}));return i.a.createElement(I.PlayerContainer,{key:t,className:e.props.whoseTurn===n.id?"highlight":"",position:0===t?"bottom":1===t&&2===a.length?"top":1===t&&3===a.length||1===t&&4===a.length?"left":2===t&&3===a.length?"right":2===t&&4===a.length?"top":"right"},i.a.createElement(I.Container2,{position:0===t?"bottom":1===t&&2===a.length?"top":1===t&&3===a.length||1===t&&4===a.length?"left":2===t&&3===a.length?"right":2===t&&4===a.length?"top":"right"},i.a.createElement(I.CardContainer,null,r),i.a.createElement(I.Hand,{src:"images/hand.png",className:"slapping"===e.props.phase&&e.props.whoseSlapping.indexOf(n.id)>=0?"move":""})),i.a.createElement(I.Name,null,n.name),i.a.createElement("h1",null,n.hand.length))})),a=this.props.pile.map((function(e,n){return i.a.createElement(I.Card,{key:n,skew:e.skew,translateX:e.translateX,translateY:e.translateY,src:e.imgUrl})})),r=this.props.players.map((function(n){return i.a.createElement("audio",{src:"audio/slap.mp3",type:"audio/mpeg",autoPlay:"slapping"===e.props.phase&&e.props.whoseSlapping.indexOf(n.id)>=0})}));return i.a.createElement(I.Container1,null,i.a.createElement(I.StartButton,{disabled:"idle"===this.props.phase||"playing"===this.props.phase,onClick:function(){return e.startGame()}},"Start"),t,i.a.createElement(I.Pile,null,a),"slapping"===this.props.phase?i.a.createElement(i.a.Fragment,null,r):null)}}]),t}(a.Component),M=Object(c.f)(h(T)),A=[{rank:"two",suit:"diamonds",imgUrl:"images/2oD.png",id:"#2oD"},{rank:"two",suit:"hearts",imgUrl:"images/2oH.png",id:"#2oH"},{rank:"two",suit:"clubs",imgUrl:"images/2oC.png",id:"#2oC"},{rank:"two",suit:"spades",imgUrl:"images/2oS.png",id:"#2oS"},{rank:"three",suit:"diamonds",imgUrl:"images/3oD.png",id:"#3oD"},{rank:"three",suit:"hearts",imgUrl:"images/3oH.png",id:"#3oH"},{rank:"three",suit:"clubs",imgUrl:"images/3oC.png",id:"#3oC"},{rank:"three",suit:"spades",imgUrl:"images/3oS.png",id:"#3oS"},{rank:"four",suit:"diamonds",imgUrl:"images/4oD.png",id:"#4oD"},{rank:"four",suit:"hearts",imgUrl:"images/4oH.png",id:"#4oH"},{rank:"four",suit:"clubs",imgUrl:"images/4oC.png",id:"#4oC"},{rank:"four",suit:"spades",imgUrl:"images/4oS.png",id:"#4oS"},{rank:"five",suit:"diamonds",imgUrl:"images/5oD.png",id:"#5oD"},{rank:"five",suit:"hearts",imgUrl:"images/5oH.png",id:"#5oH"},{rank:"five",suit:"clubs",imgUrl:"images/5oC.png",id:"#5oC"},{rank:"five",suit:"spades",imgUrl:"images/5oS.png",id:"#5oS"},{rank:"six",suit:"diamonds",imgUrl:"images/6oD.png",id:"#6oD"},{rank:"six",suit:"hearts",imgUrl:"images/6oH.png",id:"#6oH"},{rank:"six",suit:"clubs",imgUrl:"images/6oC.png",id:"#6oC"},{rank:"six",suit:"spades",imgUrl:"images/6oS.png",id:"#6oS"},{rank:"seven",suit:"diamonds",imgUrl:"images/7oD.png",id:"#7oD"},{rank:"seven",suit:"hearts",imgUrl:"images/7oH.png",id:"#7oH"},{rank:"seven",suit:"clubs",imgUrl:"images/7oC.png",id:"#7oC"},{rank:"seven",suit:"spades",imgUrl:"images/7oS.png",id:"#7oS"},{rank:"eight",suit:"diamonds",imgUrl:"images/8oD.png",id:"#8oD"},{rank:"eight",suit:"hearts",imgUrl:"images/8oH.png",id:"#8oH"},{rank:"eight",suit:"clubs",imgUrl:"images/8oC.png",id:"#8oC"},{rank:"eight",suit:"spades",imgUrl:"images/8oS.png",id:"#8oS"},{rank:"nine",suit:"diamonds",imgUrl:"images/9oD.png",id:"#9oD"},{rank:"nine",suit:"hearts",imgUrl:"images/9oH.png",id:"#9oH"},{rank:"nine",suit:"clubs",imgUrl:"images/9oC.png",id:"#9oC"},{rank:"nine",suit:"spades",imgUrl:"images/9oS.png",id:"#9oS"},{rank:"ten",suit:"diamonds",imgUrl:"images/10oD.png",id:"#10oD"},{rank:"ten",suit:"hearts",imgUrl:"images/10oH.png",id:"#10oH"},{rank:"ten",suit:"clubs",imgUrl:"images/10oC.png",id:"#10oC"},{rank:"ten",suit:"spades",imgUrl:"images/10oS.png",id:"#10oS"},{rank:"jack",suit:"diamonds",imgUrl:"images/JoD.png",id:"#JoD"},{rank:"jack",suit:"hearts",imgUrl:"images/JoH.png",id:"#JoH"},{rank:"jack",suit:"clubs",imgUrl:"images/JoC.png",id:"#JoC"},{rank:"jack",suit:"spades",imgUrl:"images/JoS.png",id:"#JoS"},{rank:"queen",suit:"diamonds",imgUrl:"images/QoD.png",id:"#QoD"},{rank:"queen",suit:"hearts",imgUrl:"images/QoH.png",id:"#QoH"},{rank:"queen",suit:"clubs",imgUrl:"images/QoC.png",id:"#QoC"},{rank:"queen",suit:"spades",imgUrl:"images/QoS.png",id:"#QoS"},{rank:"king",suit:"diamonds",imgUrl:"images/KoD.png",id:"#KoD"},{rank:"king",suit:"hearts",imgUrl:"images/KoH.png",id:"#KoH"},{rank:"king",suit:"clubs",imgUrl:"images/KoC.png",id:"#KoC"},{rank:"king",suit:"spades",imgUrl:"images/KoS.png",id:"#KoS"},{rank:"ace",suit:"diamonds",imgUrl:"images/AoD.png",id:"#AoD"},{rank:"ace",suit:"hearts",imgUrl:"images/AoH.png",id:"#AoH"},{rank:"ace",suit:"clubs",imgUrl:"images/AoC.png",id:"#AoC"},{rank:"ace",suit:"spades",imgUrl:"images/AoS.png",id:"#AoS"}],K=function(e){Object(l.a)(t,e);var n=Object(u.a)(t);function t(){var e;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).state={players:[],deck:[],pile:[],whoseTurn:"",royalCount:null,whoseRoyal:null,phase:"",whoseSlapping:[],playSound:!1},e.generateRandomId=function(){return localStorage.getItem("id")?localStorage.getItem("id"):Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},e.checkIfExists=function(e,n){for(var t=0;t<n.length;t++)if(n[t].id===e)return!0;return!1},e.shuffle=function(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),a=e[n];e[n]=e[t],e[t]=a}return e},e.test=function(){e.setState({playSound:!e.state.playSound})},e}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.findRoom(this.props.match.params.id).get().then((function(n){var t=localStorage.getItem("id")?localStorage.getItem("id"):e.generateRandomId();localStorage.setItem("id",t),n.exists?e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){e.checkIfExists(t,n.data().players)||e.props.firebase.findRoom(n.id).update({players:[].concat(Object(d.a)(n.data().players),[{id:t,name:"player".concat(n.data().players.length+1),hand:[]}])})})):e.props.firebase.createRoom().doc(e.props.match.params.id).set({players:[{id:t,name:"player1",hand:[]}],master:t,deck:Object(d.a)(e.shuffle(A)),pile:[],royalCount:null,whoseRoyal:null,whoseTurn:"",phase:"waiting",whoseSlapping:[]}),e.props.firebase.findRoom(e.props.match.params.id).onSnapshot((function(n){t===e.state.whoseTurn?(setTimeout((function(){e.setState({pile:n.data().pile})}),350),e.setState({players:n.data().players,deck:n.data().deck,whoseTurn:n.data().whoseTurn,phase:n.data().phase,whoseSlapping:n.data().whoseSlapping})):e.setState({players:n.data().players,deck:n.data().deck,pile:n.data().pile,whoseTurn:n.data().whoseTurn,phase:n.data().phase,whoseSlapping:n.data().whoseSlapping})}))}))}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{players:this.state.players,deck:this.state.deck,pile:this.state.pile,whoseTurn:this.state.whoseTurn,phase:this.state.phase,whoseSlapping:this.state.whoseSlapping,checkIfExists:this.checkIfExists,playSound:this.state.playSound}),i.a.createElement("button",{onClick:function(){return e.test()}},"try"))}}]),t}(a.Component),J=Object(c.f)(h(K));function B(){var e=Object(v.a)(["\n    height: 100vh;\n    width: 100vw;\n"]);return B=function(){return e},e}var Q={};Q.Container1=y.a.div(B());var P=Q,Y=function(e){Object(l.a)(t,e);var n=Object(u.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(c.c,null,i.a.createElement(P.Container1,null,i.a.createElement(c.a,{exact:!0,path:"/:id",render:function(){return i.a.createElement(J,null)}})))}}]),t}(a.Component),q=Object(c.f)(h(Y));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var N=t(15);o.a.render(i.a.createElement(N.a,null,i.a.createElement(m.Provider,{value:new k},i.a.createElement(q,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.ed0bd0f6.chunk.js.map