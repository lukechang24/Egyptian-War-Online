(this["webpackJsonpegyptian-war"]=this["webpackJsonpegyptian-war"]||[]).push([[0],{36:function(e,n,t){e.exports=t(51)},41:function(e,n,t){},51:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(31),o=t.n(r),s=(t(41),t(8)),l=t(11),p=t(13),u=t(12),d=t(14),c=t(9),g=i.a.createContext(null),m=function(e){return function(n){return i.a.createElement(g.Consumer,null,(function(t){return i.a.createElement(e,Object.assign({},n,{firebase:t}))}))}},h=g,f=t(19),b=(t(42),t(43),t(45),{apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_KEY,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_AUTH_DOMAIN,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_DATABASE_URL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PROJECT_ID,storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_STORAGE_BUCKET,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_MESSAGING_SENDER_ID}),v=function e(){var n=this;Object(s.a)(this,e),this.createRoom=function(){return n.db.collection("rooms")},this.findRoom=function(e){return n.db.collection("rooms").doc(e)},f.initializeApp(b),this.database=f.database(),this.db=f.firestore(),this.auth=f.auth()},k=t(4),S=t(5);function C(){var e=Object(k.a)(["\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    width: 100px;\n    height: 50px;\n"]);return C=function(){return e},e}function y(){var e=Object(k.a)(["\n\n"]);return y=function(){return e},e}function O(){var e=Object(k.a)(["\n    position: absolute;\n    right: 0;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    margin: auto;\n    width: 100px;\n    transform: ",";\n    border: 1px solid black;\n    border-radius: 15px;\n"]);return O=function(){return e},e}function w(){var e=Object(k.a)(["\n    position: relative;\n    width: 250px;\n    height: 250px;\n"]);return w=function(){return e},e}function E(){var e=Object(k.a)(["\n    /* position: absolute; */\n    /* bottom: 100%;\n    left: 100%; */\n    /* top: -","px; */\n    width: 102.5px;\n    transition: 0.2s linear;\n    &.move {\n        transform: translate(75px, calc(-100vh/2 + 102.5px));\n    }\n"]);return E=function(){return e},e}function U(){var e=Object(k.a)(["\n    position: relative;\n    display: flex;\n    justify-content: center;\n    margin-top: 25px;\n"]);return U=function(){return e},e}function _(){var e=Object(k.a)(["\n    width: 100px;\n    z-index: 100;\n    transition: 0.1s linear;\n    &.move {\n        transform: translate(-50px, calc(-100vh/2 + 102.5px));\n    }\n"]);return _=function(){return e},e}function T(){var e=Object(k.a)(["\n    width: ",";\n    height: ",";\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    transform: ",";\n"]);return T=function(){return e},e}function D(){var e=Object(k.a)(["\n    position: absolute;\n    top: ",";\n    left: ",";\n    width: 250px;\n    height: 250px;\n    display: flex;\n    flex-direction: ",";\n    justify-content: center;\n    align-items: center;\n    background-color: lightblue;\n"]);return D=function(){return e},e}function R(){var e=Object(k.a)(["\n    position: relative;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    overflow-x: hidden;\n"]);return R=function(){return e},e}var j={};j.Container1=S.a.div(R()),j.PlayerContainer=S.a.div(D(),(function(e){return"bottom"===e.position?"calc(100vh - 250px)":"top"===e.position?0:"left"===e.position||"right"===e.position?"calc(calc((100vh - 250px)/2))":0}),(function(e){return"bottom"===e.position||"top"===e.position?"calc((100vw - 250px)/2)":"left"===e.position?0:"right"===e.position?"calc(100vw - 250px)":0}),(function(e){return"bottom"===e.position?"column-reverse":"column"})),j.Container2=S.a.div(T(),(function(e){return"left"===e.position||"right"===e.position?"auto":"100%"}),(function(e){return"left"===e.position||"right"===e.position?"100%":"auto"}),(function(e){return"top"===e.position?"rotate(180deg)":"left"===e.position?"rotate(90deg)":"right"===e.position?"rotate(270deg)":0})),j.Hand=S.a.img(_()),j.CardContainer=S.a.div(U()),j.CardBack=S.a.img(E(),(function(e){return e.layer?2*e.layer:0})),j.Pile=S.a.div(w()),j.Card=S.a.img(O(),(function(e){return"rotate(".concat(e.skew,"deg) translate(").concat(e.translateX,"px, ").concat(e.translateY,"px)")})),j.Name=S.a.h1(y()),j.StartButton=S.a.button(C());var x=j,H=function(e){Object(p.a)(t,e);var n=Object(u.a)(t);function t(){var e;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).unsubscribe=null,e.startGame=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){var t=n.data().players,a=Math.floor(Math.random()*t.length),i=t[a].id,r=e.props.deck;t.forEach((function(n){n.hand=r.splice(0,Math.floor(52/e.props.players.length))})),console.log(r),t[a].hand=t[a].hand.concat(r),e.props.firebase.findRoom(n.id).update({players:t,whoseTurn:i,phase:"idle"})}))},e.prepareCard=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){e.props.firebase.findRoom(n.id).update({phase:"playing"}),setTimeout((function(){e.placeCard()}),100)}))},e.placeCard=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){for(var t=localStorage.getItem("id"),a=n.data().players,i=n.data().pile,r=null,o=null,s=null,l=0;l<a.length;l++)if(a[l].id===t){var p=a[l].hand,u=p.pop();u.skew=100*Math.random()-50,u.translateX=30*Math.random()-15,u.translateY=30*Math.random()-15,i.push(u),a[l].hand=p,o="jack"===u.rank?1:"queen"===u.rank?2:"king"===u.rank?3:"ace"===u.rank?4:null,s=o>0?t:n.data().whoseRoyal,r=l===a.length-1?a[0].id:a[l+1].id}n.data().royalCount>1&&!o?(console.log("i went first"),o=n.data().royalCount-1,r=localStorage.getItem("id")):1!==n.data().royalCount||o||(console.log("i went 2nd"),e.unsubscribe=setTimeout((function(){for(var t=0;t<a.length;t++)if(a[t].id===n.data().whoseRoyal){var l=a[t].hand.reverse().concat(i);return a[t].hand=l.reverse(),i=[],s=null,o=null,void e.props.firebase.findRoom(n.id).update({players:a,pile:i,royalCount:o,whoseRoyal:s,whoseTurn:r,phase:"idle"})}}),1e3)),e.props.firebase.findRoom(n.id).update({players:a,pile:i,royalCount:o,whoseRoyal:s,whoseTurn:r,phase:"idle"})}))},e.prepareSlap=function(){var n=localStorage.getItem("id");e.props.firebase.findRoom(e.props.match.params.id).get().then((function(t){e.props.firebase.findRoom(t.id).update({phase:"slapping",whoseSlapping:[n]}),setTimeout((function(){e.slap()}),100)}))},e.slap=function(){var n=localStorage.getItem("id"),t=Object(d.a)(e.props.pile);t.length<=1||t[t.length-1].rank!==t[t.length-2].rank&&2===t.length?e.burn():t[t.length-1].rank===t[t.length-2].rank||t[t.length-1].rank===t[t.length-3].rank?(clearTimeout(e.unsubscribe),e.props.firebase.findRoom(e.props.match.params.id).get().then((function(a){for(var i=a.data().players,r=0;r<i.length;r++)if(i[r].id===n){var o=i[r].hand.reverse().concat(t);i[r].hand=o.reverse()}e.props.firebase.findRoom(a.id).update({players:i,pile:[],royalCount:null,whoseRoyal:null,whoseTurn:n,phase:"idle",whoseSlapping:[]})}))):(e.unsubscribe&&clearTimeout(e.unsubscribe),e.burn(),e.unsubscribe&&e.createDelay())},e.burn=function(){var n=localStorage.getItem("id");e.props.firebase.findRoom(e.props.match.params.id).get().then((function(t){for(var a=t.data().players,i=t.data().pile,r=0;r<a.length;r++)if(a[r].id===n){var o=a[r].hand,s=o.pop();s.skew=360*Math.random()-180,s.translateX=30*Math.random()-15,s.translateY=30*Math.random()-15,i.unshift(s),a[r].hand=o}e.props.firebase.findRoom(t.id).update({players:a,pile:i,phase:"idle",whoseSlapping:[]})}))},e.createDelay=function(){e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){var t=n.data().players,a=n.data().pile,i=null,r=null;e.unsubscribe=setTimeout((function(){for(var o=0;o<t.length;o++)if(t[o].id===n.data().whoseRoyal){var s=t[o].hand.reverse().concat(a);return t[o].hand=s.reverse(),a=[],r=null,i=null,void e.props.firebase.findRoom(n.id).update({players:t,pile:a,royalCount:i,whoseRoyal:r,phase:"idle"})}}),1e3)}))},e.rotateIds=function(n,t){var a=Object(d.a)(t);if(e.props.checkIfExists(n,a))for(;a[0].id!==n;)a.unshift(a.pop());else console.log("id not found");return a},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,n=localStorage.getItem("id");document.addEventListener("keydown",(function(t){if("idle"===e.props.phase&&38===t.which&&n===e.props.whoseTurn)e.prepareCard();else if("idle"===e.props.phase&&32===t.which){new Audio("audio/slap.mp3").play(),e.prepareSlap()}}))}},{key:"render",value:function(){var e=this,n=localStorage.getItem("id"),t=this.rotateIds(n,this.props.players).map((function(n,t,a){var r=n.hand.slice(0,1).map((function(t,a){return i.a.createElement(x.CardBack,{className:"playing"===e.props.phase&&e.props.whoseTurn===n.id&&0===a?"move":"",key:a,layer:a,src:"images/back2.png"})}));return i.a.createElement(x.PlayerContainer,{key:t,position:0===t?"bottom":1===t&&2===a.length?"top":1===t&&3===a.length||1===t&&4===a.length?"left":2===t&&3===a.length?"right":2===t&&4===a.length?"top":"right"},i.a.createElement(x.Container2,{position:0===t?"bottom":1===t&&2===a.length?"top":1===t&&3===a.length||1===t&&4===a.length?"left":2===t&&3===a.length?"right":2===t&&4===a.length?"top":"right"},i.a.createElement(x.CardContainer,null,r),i.a.createElement(x.Hand,{src:"images/hand.png",className:"slapping"===e.props.phase&&e.props.whoseSlapping.indexOf(n.id)>=0?"move":""}),console.log(e.props.whoseSlapping)),i.a.createElement(x.Name,null,n.name),i.a.createElement("h1",null,n.hand.length))})),a=this.props.pile.map((function(e,n){return i.a.createElement(x.Card,{key:n,skew:e.skew,translateX:e.translateX,translateY:e.translateY,src:e.imgUrl})}));return i.a.createElement(x.Container1,null,i.a.createElement(x.StartButton,{disabled:"idle"===this.props.phase||"playing"===this.props.phase,onClick:function(){return e.startGame()}},"Start"),t,i.a.createElement(x.Pile,null,a))}}]),t}(a.Component),A=Object(c.f)(m(H)),P=[{rank:"two",suit:"diamonds",imgUrl:"images/2D.png",id:"#2oD"},{rank:"two",suit:"hearts",imgUrl:"images/2H.png",id:"#2oH"},{rank:"two",suit:"clubs",imgUrl:"images/2C.png",id:"#2oC"},{rank:"two",suit:"spades",imgUrl:"images/2S.png",id:"#2oS"},{rank:"three",suit:"diamonds",imgUrl:"images/3D.png",id:"#3oD"},{rank:"three",suit:"hearts",imgUrl:"images/3H.png",id:"#3oH"},{rank:"three",suit:"clubs",imgUrl:"images/3C.png",id:"#3oC"},{rank:"three",suit:"spades",imgUrl:"images/3S.png",id:"#3oS"},{rank:"four",suit:"diamonds",imgUrl:"images/4D.png",id:"#4oD"},{rank:"four",suit:"hearts",imgUrl:"images/4H.png",id:"#4oH"},{rank:"four",suit:"clubs",imgUrl:"images/4C.png",id:"#4oC"},{rank:"four",suit:"spades",imgUrl:"images/4S.png",id:"#4oS"},{rank:"five",suit:"diamonds",imgUrl:"images/5D.png",id:"#5oD"},{rank:"five",suit:"hearts",imgUrl:"images/5H.png",id:"#5oH"},{rank:"five",suit:"clubs",imgUrl:"images/5C.png",id:"#5oC"},{rank:"five",suit:"spades",imgUrl:"images/5S.png",id:"#5oS"},{rank:"six",suit:"diamonds",imgUrl:"images/6D.png",id:"#6oD"},{rank:"six",suit:"hearts",imgUrl:"images/6H.png",id:"#6oH"},{rank:"six",suit:"clubs",imgUrl:"images/6C.png",id:"#6oC"},{rank:"six",suit:"spades",imgUrl:"images/6S.png",id:"#6oS"},{rank:"seven",suit:"diamonds",imgUrl:"images/7D.png",id:"#7oD"},{rank:"seven",suit:"hearts",imgUrl:"images/7H.png",id:"#7oH"},{rank:"seven",suit:"clubs",imgUrl:"images/7C.png",id:"#7oC"},{rank:"seven",suit:"spades",imgUrl:"images/7S.png",id:"#7oS"},{rank:"eight",suit:"diamonds",imgUrl:"images/8D.png",id:"#8oD"},{rank:"eight",suit:"hearts",imgUrl:"images/8H.png",id:"#8oH"},{rank:"eight",suit:"clubs",imgUrl:"images/8C.png",id:"#8oC"},{rank:"eight",suit:"spades",imgUrl:"images/8S.png",id:"#8oS"},{rank:"nine",suit:"diamonds",imgUrl:"images/9D.png",id:"#9oD"},{rank:"nine",suit:"hearts",imgUrl:"images/9H.png",id:"#9oH"},{rank:"nine",suit:"clubs",imgUrl:"images/9C.png",id:"#9oC"},{rank:"nine",suit:"spades",imgUrl:"images/9S.png",id:"#9oS"},{rank:"ten",suit:"diamonds",imgUrl:"images/10D.png",id:"#10oD"},{rank:"ten",suit:"hearts",imgUrl:"images/10H.png",id:"#10oH"},{rank:"ten",suit:"clubs",imgUrl:"images/10C.png",id:"#10oC"},{rank:"ten",suit:"spades",imgUrl:"images/10S.png",id:"#10oS"},{rank:"jack",suit:"diamonds",imgUrl:"images/JD.png",id:"#JoD"},{rank:"jack",suit:"hearts",imgUrl:"images/JH.png",id:"#JoH"},{rank:"jack",suit:"clubs",imgUrl:"images/JC.png",id:"#JoC"},{rank:"jack",suit:"spades",imgUrl:"images/JS.png",id:"#JoS"},{rank:"queen",suit:"diamonds",imgUrl:"images/QD.png",id:"#QoD"},{rank:"queen",suit:"hearts",imgUrl:"images/QH.png",id:"#QoH"},{rank:"queen",suit:"clubs",imgUrl:"images/QC.png",id:"#QoC"},{rank:"queen",suit:"spades",imgUrl:"images/QS.png",id:"#QoS"},{rank:"king",suit:"diamonds",imgUrl:"images/KD.png",id:"#KoD"},{rank:"king",suit:"hearts",imgUrl:"images/KH.png",id:"#KoH"},{rank:"king",suit:"clubs",imgUrl:"images/KC.png",id:"#KoC"},{rank:"king",suit:"spades",imgUrl:"images/KS.png",id:"#KoS"},{rank:"ace",suit:"diamonds",imgUrl:"images/AD.png",id:"#AoD"},{rank:"ace",suit:"hearts",imgUrl:"images/AH.png",id:"#AoH"},{rank:"ace",suit:"clubs",imgUrl:"images/AC.png",id:"#AoC"},{rank:"ace",suit:"spades",imgUrl:"images/AS.png",id:"#AoS"}],I=function(e){Object(p.a)(t,e);var n=Object(u.a)(t);function t(){var e;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).state={players:[],deck:[],pile:[],whoseTurn:"",royalCount:null,whoseRoyal:null,phase:"",whoseSlapping:[]},e.generateRandomId=function(){return localStorage.getItem("id")?localStorage.getItem("id"):Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},e.checkIfExists=function(e,n){for(var t=0;t<n.length;t++)if(n[t].id===e)return!0;return!1},e.shuffle=function(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),a=e[n];e[n]=e[t],e[t]=a}return e},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.findRoom(this.props.match.params.id).get().then((function(n){var t=e.generateRandomId();n.exists?e.props.firebase.findRoom(e.props.match.params.id).get().then((function(n){e.checkIfExists(t,n.data().players)||e.props.firebase.findRoom(n.id).update({players:[].concat(Object(d.a)(n.data().players),[{id:t,name:"player".concat(n.data().players.length+1),hand:[]}])})})):e.props.firebase.createRoom().doc(e.props.match.params.id).set({players:[{id:t,name:"player1",hand:[]}],master:t,deck:Object(d.a)(e.shuffle(P)),pile:[],royalCount:null,whoseRoyal:null,whoseTurn:"",phase:"waiting",whoseSlapping:[]}),e.props.firebase.findRoom(e.props.match.params.id).onSnapshot((function(n){e.setState({players:n.data().players,deck:n.data().deck,pile:n.data().pile,whoseTurn:n.data().whoseTurn,phase:n.data().phase,whoseSlapping:n.data().whoseSlapping})}))}))}},{key:"render",value:function(){return i.a.createElement(A,{players:this.state.players,deck:this.state.deck,pile:this.state.pile,whoseTurn:this.state.whoseTurn,phase:this.state.phase,whoseSlapping:this.state.whoseSlapping,checkIfExists:this.checkIfExists})}}]),t}(a.Component),K=Object(c.f)(m(I));function W(){var e=Object(k.a)(["\n    height: 100vh;\n    width: 100vw;\n"]);return W=function(){return e},e}var N={};N.Container1=S.a.div(W());var M=N,B=function(e){Object(p.a)(t,e);var n=Object(u.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(c.c,null,i.a.createElement(M.Container1,null,i.a.createElement(c.a,{exact:!0,path:"/:id",render:function(){return i.a.createElement(K,null)}})))}}]),t}(a.Component),L=Object(c.f)(m(B));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=t(15);o.a.render(i.a.createElement(J.a,null,i.a.createElement(h.Provider,{value:new v},i.a.createElement(L,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.77530eb0.chunk.js.map